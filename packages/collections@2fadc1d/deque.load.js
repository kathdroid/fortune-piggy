montageDefine("2fadc1d","deque",{dependencies:["./shim-object","./generic-collection","./generic-order","./listen/range-changes"],factory:function(e,t,n){"use strict";function r(e,t){return this instanceof r?(this.capacity=this.snap(t),this.init(),this.length=0,this.front=0,this.addEach(e),void 0):new r(e,t)}function i(e,t,n,r,i){for(var a=0;i>a;++a)n[a+r]=e[a+t]}function a(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}e("./shim-object");var s=e("./generic-collection"),o=e("./generic-order"),l=e("./listen/range-changes");n.exports=r,Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,l.prototype),r.prototype.maxCapacity=0|1<<30,r.prototype.minCapacity=16,r.prototype.constructClone=function(e){return new this.constructor(e,this.capacity)},r.prototype.add=function(e){this.push(e)},r.prototype.push=function(e){var t=arguments.length,n=this.length;if(this.dispatchesRangeChanges){for(var r=Array(t),i=0;t>i;++i)r[i]=arguments[i];var a=[];this.dispatchBeforeRangeChange(r,a,n)}if(t>1){var s=this.capacity;if(n+t>s)for(var i=0;t>i;++i){this.ensureCapacity(n+1);var o=this.front+n&this.capacity-1;this[o]=arguments[i],n++,this.length=n}else{for(var o=this.front,i=0;t>i;++i)this[o+n&s-1]=arguments[i],o++;this.length=n+t}}else if(1===t){this.ensureCapacity(n+1);var l=this.front+n&this.capacity-1;this[l]=e,this.length=n+1}return this.dispatchesRangeChanges&&this.dispatchRangeChange(r,a,n),this.length},r.prototype.pop=function(){var e=this.length;if(0!==e){var t=this.front+e-1&this.capacity-1,n=this[t];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[n],e-1),this[t]=void 0,this.length=e-1,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[n],e-1),n}},r.prototype.shift=function(){if(0!==this.length){var e=this.front,t=this[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[t],0),this[e]=void 0,this.front=e+1&this.capacity-1,this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[t],0),t}},r.prototype.unshift=function(e){var t=this.length,n=arguments.length;if(this.dispatchesRangeChanges){for(var r=Array(n),i=0;n>i;++i)r[i]=arguments[i];var a=[];this.dispatchBeforeRangeChange(r,a,0)}if(n>1){var s=this.capacity;if(t+n>s)for(var i=n-1;i>=0;i--){this.ensureCapacity(t+1);var s=this.capacity,o=(this.front-1&s-1^s)-s;this[o]=arguments[i],t++,this.front=o,this.length=t}else{for(var l=this.front,i=n-1;i>=0;i--){var o=(l-1&s-1^s)-s;this[o]=arguments[i],l=o}this.front=l,this.length=t+n}}else if(1===n){this.ensureCapacity(t+1);var s=this.capacity,o=(this.front-1&s-1^s)-s;this[o]=e,this.length=t+1,this.front=o}return this.dispatchesRangeChanges&&this.dispatchRangeChange(r,a,0),this.length},r.prototype.clear=function(){this.length=0,this.front=0,this.init()},r.prototype.ensureCapacity=function(e){e>this.capacity&&this.grow(this.snap(1.5*this.capacity+16))},r.prototype.grow=function(e){var t=this.front,n=this.capacity,r=Array(n),a=this.length;if(i(this,0,r,0,n),this.capacity=e,this.init(),this.front=0,n>=t+a)i(r,t,this,0,a);else{var s=a-(t+a&n-1);i(r,t,this,0,s),i(r,0,this,s,a-s)}},r.prototype.init=function(){for(var e=0;this.capacity>e;++e)this[e]="nil"},r.prototype.snap=function(e){return"number"!=typeof e?this.minCapacity:a(Math.min(this.maxCapacity,Math.max(this.minCapacity,e)))},r.prototype.one=function(){return this.length>0?this[this.front]:void 0},r.prototype.peek=function(){return 0!==this.length?this[this.front]:void 0},r.prototype.poke=function(e){0!==this.length&&(this[this.front]=e)},r.prototype.peekBack=function(){var e=this.length;if(0!==e){var t=this.front+e-1&this.capacity-1;return this[t]}},r.prototype.pokeBack=function(e){var t=this.length;if(0!==t){var n=this.front+t-1&this.capacity-1;this[n]=e}},r.prototype.get=function(e){return e!==(0|e)||(0>e&&(e+=this.length),0>e||e>=this.length)?void 0:this[this.front+e&this.capacity-1]},r.prototype.indexOf=function(e,t){null==t&&(t=0),0>t&&(t+=this.length);for(var n=this.capacity-1;this.length>t;t++){var r=this.front+t&n;if(this[r]===e)return t}return-1},r.prototype.lastIndexOf=function(e,t){null==t&&(t=this.length-1),0>t&&(t+=this.length);for(var n=this.capacity-1;t>=0;t--){var r=this.front+t&n;if(this[r]===e)return t}return-1},r.prototype.find=function(e,t,n){t=t||Object.equals,null==n&&(n=0),0>n&&(n+=this.length);for(var r=this.capacity-1;this.length>n;n++){var i=this.front+n&r;if(t(e,this[i]))return n}return-1},r.prototype.findLast=function(e,t,n){t=t||Object.equals,null==n&&(n=this.length-1),0>n&&(n+=this.length);for(var r=this.capacity-1;n>=0;n--){var i=this.front+n&r;if(t(e,this[i]))return n}return-1},r.prototype.has=function(e,t){t=t||Object.equals;for(var n=this.capacity-1,r=0;this.length>r;r++){var i=this.front+r&n;if(this[i]===e)return!0}return!1},r.prototype.reduce=function(e,t){for(var n=arguments[2],r=this.capacity-1,i=0;this.length>i;i++){var a=this.front+i&r;t=e.call(n,t,this[a],i,this)}return t},r.prototype.reduceRight=function(e,t){for(var n=arguments[2],r=this.capacity-1,i=this.length-1;i>=0;i--){var a=this.front+i&r;t=e.call(n,t,this[a],i,this)}return t}}});